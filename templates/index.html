<!DOCTYPE html>
<html>
<head>
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="red-bg">
  <div class="fog-overlay"></div>
  <h1>{{ title }}</h1>
  <p>{{ caption }}</p>
  <a href="{{ url_for('step') }}">Begin Scroll</a>
  
  <!-- ðŸŽµ Audio Element with Manual Control -->
<audio id="ritual-audio" controls preload="auto">
  <source src="{{ url_for('static', filename='audio/golden-haze-01.mp3') }}" type="audio/mpeg">
  Your browser does not support the audio element.
</audio>
<script>
  const audio = document.getElementById('ritual-audio');
  const optionButtons = document.querySelectorAll('button[name="choice"]');

  optionButtons.forEach(button => {
    button.addEventListener('click', event => {
      event.preventDefault(); // Stop form from submitting immediately

      const choice = event.target.value;
      let newSrc = '';

      if (choice === 'option1') {
        newSrc = "{{ url_for('static', filename='audio/golden-haze-01.mp3') }}";
      } else if (choice === 'option2') {
        newSrc = "{{ url_for('static', filename='audio/stutters-in-silence-01.mp3') }}";
      }

      // Update audio source and play
      audio.src = newSrc;
      audio.load();
      audio.play();

      // Delay scroll transition so audio can begin
      setTimeout(() => {
        event.target.form.submit();
      }, 1000); // Adjust delay as needed
    });
  });
</script>

<!-- ðŸ§  Selection Buttons -->
<form method="POST" action="/step">
  <button name="choice" value="option1">Option 1</button>
  <button name="choice" value="option2">Option 2</button>
</form>

</body>
</html>
