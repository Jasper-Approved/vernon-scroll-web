<!DOCTYPE html>
<html>
<head>
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="red-bg">
  <div class="fog-overlay"></div>
  <h1>{{ title }}</h1>
  <p>{{ caption }}</p>
  <a href="{{ url_for('step') }}">Begin Scroll</a>

  <!-- ðŸŽµ Ritual Audio Element -->
  <audio id="ritual-audio" preload="auto">
    <source src="" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <!-- ðŸ§  Selection Buttons with Audio URLs -->
  <form method="POST" action="/step">
    <button name="choice" value="option1"
            data-audio="{{ url_for('static', filename='audio/golden-haze-01.mp3') }}">
      Option 1
    </button>
    <button name="choice" value="option2"
            data-audio="{{ url_for('static', filename='audio/stutters-in-silence-01.mp3') }}">
      Option 2
    </button>
  </form>

  <!-- ðŸ§ª Ritual Script -->
  <script>
    const audio = document.getElementById('ritual-audio');
    const optionButtons = document.querySelectorAll('button[name="choice"]');

    optionButtons.forEach(button => {
      button.addEventListener('click', event => {
        event.preventDefault();

        const newSrc = event.target.dataset.audio;
        audio.src = newSrc;
        audio.load();
        audio.play();

        setTimeout(() => {
          event.target.form.submit();
        }, 1000); // Delay to let audio begin
      });
    });
  </script>
</body>
</html>

