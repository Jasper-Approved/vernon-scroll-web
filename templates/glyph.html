<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scroll Interpretation</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="red-bg">

  <!-- 🌌 Layer Container — Background + Glyph + Fog -->
  <div id="layer-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; overflow: hidden;">
    
    <!-- 🖼️ Background Image -->
    <img src="{{ background_style.image }}"
         style="
           position: absolute;
           top: 0;
           left: 0;
           width: 100%;
           height: 100%;
           object-fit: {{ background_style.object_fit | default('cover') }};
           opacity: {{ background_style.opacity | default('0.5') }};
           z-index: 0;
         ">

    <!-- 🧿 Glyph Overlay -->
    {% if remedy.glyph %}
    <img src="{{ url_for('static', filename='backgrounds/' + remedy.glyph) }}"
         style="
           position: absolute;
           top: {{ remedy.glyph_style.top | default('0') }};
           left: {{ remedy.glyph_style.left | default('0') }};
           width: {{ remedy.glyph_style.width | default('100vw') }};
           height: {{ remedy.glyph_style.height | default('100vh') }};
           object-fit: {{ remedy.glyph_style.object_fit | default('cover') }};
           opacity: {{ remedy.glyph_style.opacity | default('0.5') }};
           mix-blend-mode: {{ remedy.glyph_style.blend_mode | default('multiply') }};
           z-index: 1;
           pointer-events: none;
         ">
    {% endif %}

    <!-- 🌫️ Fog Overlay -->
    <div class="fog-overlay"></div>
  </div>

  <!-- 📜 Scroll Content -->
  <div class="scroll-container">
    {% if step.text %}
      <h2 class="ritual-text">{{ step.text }}</h2>
      <form method="post">
        <button type="submit">{{ 'Continue' if step.pause else 'Next' }}</button>
      </form>
    {% elif step.question %}
      <h2 class="ritual-text">{{ step.question }}</h2>
      <form method="post">
        <input type="hidden" name="question" value="{{ step.question }}">
        <button name="response" value="yes">Yes</button>
        <button name="response" value="no">No</button>
      </form>
    {% else %}
      <a href="{{ url_for('lineage') }}">Complete Scroll</a>
    {% endif %}

    <!-- 🧬 Lineage Trail -->
    <hr>
    <h4>🧬 Lineage:</h4>
    <ul>
      {% for entry in lineage %}
        <li>{{ entry }}</li>
      {% endfor %}
    </ul>
  </div>

</body>
</html>



